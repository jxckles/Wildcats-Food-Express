"use strict";
process.chdir(__dirname);
const region = process.env.VERCEL_REGION || process.env.NOW_REGION;
if (!process.env.NODE_ENV) {
  process.env.NODE_ENV = region === "dev1" ? "development" : "production";
}
if (process.env.NODE_ENV !== "production" && region !== "dev1") {
  console.warn(
    `Warning: NODE_ENV was incorrectly set to "${process.env.NODE_ENV}", this value is being overridden to "production"`
  );
  process.env.NODE_ENV = "production";
}
const NextServer = require("__NEXT_SERVER_PATH__").default;
const nextServer = new NextServer({
  // @ts-ignore __NEXT_CONFIG__ value is injected
  conf: __NEXT_CONFIG__,
  dir: ".",
  minimalMode: true,
  customServer: false
});
const requestHandler = nextServer.getRequestHandler();
module.exports = async (req, res) => {
  try {
    await requestHandler(req, res);
  } catch (err) {
    console.error(err);
    process.exit(1);
  }
};
